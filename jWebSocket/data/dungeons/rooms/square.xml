<?xml version="1.0" encoding="UTF-8"?>
<rooms>
	<room id="square">
	    <generator>
	        <![CDATA[
	        var xOffset = _digger_.randomI(0, _digger_.cellSize()/2);
	        var yOffset = _digger_.randomI(0, _digger_.cellSize()/2);
	        var size = _digger_.randomI(4, _digger_.cellSize() - Math.max(xOffset, yOffset));
	        var floorMaterial = _mat_DOLOMITE_FLOOR_0;
	        var wallMaterial = _mat_DOLOMITE_WALL_0;
	        
	        if (_args_.x != undefined) {
	           xOffset = _args_.x; 
	        }
	        
	        if (_args_.y != undefined) {
               yOffset = _args_.y; 
            }
            
            if (_args_.size != undefined) {
               size = _args_.size; 
            }
            
            if (_args_.floor != undefined) {
               floorMaterial = _args_.floor; 
            }
            
            if (_args_.wall != undefined) {
               wallMaterial = _args_.wall; 
            }
	        
	        //south and north walls
	        for (var x = xOffset; x < xOffset + size; x++) {
	            _digger_.digCellTile(x, yOffset, wallMaterial);
	            _digger_.digCellTile(x, yOffset + size-1, wallMaterial);
	        }
	        
	        //south and north walls
	        for (var y = yOffset; y < yOffset + size; y++) {
	            _digger_.digCellTile(xOffset, y, wallMaterial);
	            _digger_.digCellTile(xOffset + size-1, y, wallMaterial);
	        }
	        
	        //floor
	        for (var y = yOffset + 1; y < yOffset + size-1; y++) {
	            for (var x = xOffset + 1; x < xOffset + size-1; x++) {
	                _digger_.digCellTile(x, y, floorMaterial);
	            }
	        }
	        
	        var entrancesList = _digger_.entrances();            
	        var eSize = entrancesList.size();
	        
	        if (_args_.exits & 0x000F == 0x000F) {
	           var start = _digger_.randomI(1, size - 1); //don't select room's corners
	           _digger_.digNorthExitCorridor(xOffset + start, yOffset, floorMaterial, wallMaterial);
	        }
	        
	        if (_args_.exits & 0x00F0 == 0x00F0) {
		        start = _digger_.randomI(1, size - 1); //don't select room's corners
		        _digger_.digEastExitCorridor(xOffset + size - 1, yOffset + start, floorMaterial, wallMaterial);
		    }
	        
	        if (_args_.exits & 0x0F00 == 0x0F00) {
		        start = _digger_.randomI(1, size - 1); //don't select room's corners
		        _digger_.digSouthExitCorridor(xOffset + start, yOffset + size - 1, floorMaterial, wallMaterial);
            }
            	        
	        if (_args_.exits & 0xF000 == 0xF000) {
		        start = _digger_.randomI(1, size - 1); //don't select room's corners
		        _digger_.digWestExitCorridor(xOffset, yOffset + start, floorMaterial, wallMaterial);
            }	        
	        ]]>
	    </generator>
	</room>
</rooms>